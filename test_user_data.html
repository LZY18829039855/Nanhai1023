<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>用户数据测试</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .user-item { margin: 10px 0; padding: 10px; border: 1px solid #ccc; border-radius: 5px; }
        .ai-group { background-color: #e3f2fd; }
        .non-ai-group { background-color: #fce4ec; }
        .stats { background-color: #f5f5f5; padding: 15px; margin: 20px 0; border-radius: 5px; }
    </style>
</head>
<body>
    <h1>用户数据测试页面</h1>
    <div class="stats">
        <h3>统计信息</h3>
        <p>总人数: <span id="total-count">加载中...</span></p>
        <p>AI组人数: <span id="ai-count">加载中...</span></p>
        <p>非AI组人数: <span id="non-ai-count">加载中...</span></p>
    </div>
    
    <div id="user-list">
        <p>加载中...</p>
    </div>

    <script>
        async function loadUserData() {
            try {
                const response = await fetch('/api/user-info');
                if (!response.ok) {
                    throw new Error('无法获取用户数据');
                }
                
                const result = await response.json();
                console.log('API响应:', result);
                
                if (result.code === 200 && result.data && result.data.length > 0) {
                    const users = result.data;
                    
                    // 更新统计信息
                    const aiCount = users.filter(u => u.groupType === 'AI Group').length;
                    const nonAiCount = users.filter(u => u.groupType === 'Non-AI Group').length;
                    const totalCount = users.length;
                    
                    document.getElementById('total-count').textContent = totalCount;
                    document.getElementById('ai-count').textContent = aiCount;
                    document.getElementById('non-ai-count').textContent = nonAiCount;
                    
                    // 显示用户列表
                    const userListDiv = document.getElementById('user-list');
                    userListDiv.innerHTML = '<h3>用户列表</h3>';
                    
                    users.forEach(user => {
                        const userDiv = document.createElement('div');
                        userDiv.className = `user-item ${user.groupType === 'AI Group' ? 'ai-group' : 'non-ai-group'}`;
                        userDiv.innerHTML = `
                            <strong>${user.userName}</strong> (${user.employId})<br>
                            组别: ${user.groupType} | 小组: ${user.subGroup}<br>
                            英文名: ${user.userEngName}
                        `;
                        userListDiv.appendChild(userDiv);
                    });
                    
                    console.log(`成功加载 ${totalCount} 个用户 (AI组:${aiCount}, 非AI组:${nonAiCount})`);
                } else {
                    document.getElementById('user-list').innerHTML = '<p>没有用户数据</p>';
                }
            } catch (error) {
                console.error('加载用户数据失败:', error);
                document.getElementById('user-list').innerHTML = '<p>加载失败: ' + error.message + '</p>';
            }
        }
        
        // 页面加载时获取数据
        loadUserData();
    </script>
</body>
</html>

